{% extends 'base.html.twig' %}

{% block title 'les etudiant' %}
{% block body %}
    <div class="jumbotron text-center">
        <h1>   <label  for="topicOptions" style="font-size: 28px; color: #5bc0de;" class="ng-binding" >Gestion des événements </label> </h1>
        <div class="input-group input-group-sm">
            <input id="search" type="text" class="form-control" placeholder="Taper le nom">
            <span class="input-group-btn">
                      <button type="button" class="btn btn-info btn-flat"><i class="fa fa-search"></i></button>
                    </span>



        </div>
    </div>

    <ul class="nav nav-second-level" id="entitiesNav">
    </ul>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(function() {
            var searchRequest = null;
            $("#search").keyup(function() {
                var minlength = 1;
                var that = this;
                var value = $(this).val();
                var entitySelector = $("#entitiesNav").html('');
                if (value.length >= minlength ) {
                    if (searchRequest != null)
                        searchRequest.abort();
                    searchRequest = $.ajax({
                        type: "GET",
                        url: "{{ path('search') }}",
                        data: {
                            'q' : value
                        },
                        dataType: "text",
                        success: function(msg){
                            //we need to check if the value is the same
                            if (value===$(that).val()) {
                                var result = JSON.parse(msg);
                                $.each(result, function(key, arr) {
                                    $.each(arr, function(id, value) {
                                        if (key === 'evenement') {
                                            if (id !== 'error') {
                                                console.log(value[0]);

                                                entitySelector.append('<ul> ');
                                                entitySelector.append('<li><a href="readOne/'+id+'">'+value[0]+'<a/></li>');
                                                entitySelector.append('</ul> ');
                                                entitySelector.append('');


                                            } else {
                                                entitySelector.append('<li class="errorLi">'+value+'</li>');
                                            }
                                        }
                                    });
                                });
                            }
                        }
                    });
                }
            });
        });
    </script>




    <br><br>
    <h2><label  for="topicOptions" style="font-size: 20px; color: #5bc0de;" class="ng-binding" >caracteristiques </label></h2>

    <TABLE class="table table-striped" >
        <tr> <th > <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Lieu</label></th>
            <th> <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Nom</label></th>
            <th> <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Prix</label></th>
            <th><label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Nb_places</label> </th>
            <th> <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Date</label> </th>
            <th> <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Photo</label> </th>
            <th> <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Actions</label> </th></tr>




        {% for e in evenements %}


            <tr>
                <td>  <i class="fa fa-child"></i> {{ e.lieu }}</td>
                <td>  {{ e.nom }}</td>
                <td>  {{ e.prix | number_format(0,'',' ')}}</td>
                <td>  {{ e.nbPlaces }}</td>
                <td>  {{ e.dateEvent|date("F - d - Y") }}</td>
                <td><img src="{{ asset('bundles/images/' ~ e.photo) }}" alt="vide" width="100px"></td>




                <td>  <a href="{{ path('evenement_supprimer',{'id':e.id}) }}" class="btn btn-primary"><i class="fa fa-trash"></i> </a>



                    <form action="{{ path('evenement_modifier',{'id':e.id}) }}" style="display: inline-block" onsubmit="return confirm('Etes vous vraiment sur?')">
                        <input type="hidden" name="method" value="modifier">

                        <button class="btn btn-primary" ><i class="fa fa-edit"></i> </button>



                    </form>
                    <form action="{{ path('evenement_inscriAdd',{'id':e.id}) }}" style="display: inline-block" onsubmit="return confirm('Etes vous vraiment sur?')">
                        <input type="hidden" name="method" value="show">
                        <button class="btn btn-primary"><i class="fa fa-eye"></i> </button>


                    </form>

                    <form action="{{ path('insc_read_event',{'id':e.id}) }}" style="display: inline-block" onsubmit="return confirm('Etes vous vraiment sur?')">
                        <input type="hidden" name="method" value="afficher">
                        <button class="btn btn-primary"><i class="fa fa-book"></i> </button>


                    </form>


                </td>


            </tr>
        {% endfor %}
    </TABLE>

    <br>

    <div class="text-left">

        <a href="{{ path('event_ajouter') }}" class="btn btn-primary">  <i class="fa fa-save"> <br> Ajouter</i></a>
    </div>



    </div>

    <div class="navigation">
        {{ knp_pagination_render(evenements) }}
    </div>






{% endblock %}

