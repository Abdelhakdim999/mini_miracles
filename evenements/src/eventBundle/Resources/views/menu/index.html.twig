{% extends 'base.html.twig' %}

{% block title 'les etudiant' %}
{% block body %}
    <div class="jumbotron text-center">
        <h1>   <label  for="topicOptions" style="font-size: 28px; color: #5bc0de;" class="ng-binding" >Gestion des menus </label> </h1>
        <div class="input-group input-group-sm">
            <input id="search" type="text" class="form-control" placeholder="Taper le nom">
            <span class="input-group-btn">
                      <button type="button" class="btn btn-info btn-flat"><i class="fa fa-search"></i></button>
                    </span>
        </div>
    </div>

    <ul class="nav nav-second-level" id="entitiesNav">
    </ul>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(function() {
            var searchRequest = null;
            $("#search").keyup(function() {
                var minlength = 1;
                var that = this;
                var value = $(this).val();
                var entitySelector = $("#entitiesNav").html('');
                if (value.length >= minlength ) {
                    if (searchRequest != null)
                        searchRequest.abort();
                    searchRequest = $.ajax({
                        type: "GET",
                        url: "{{ path('menu_searchc') }}",
                        data: {
                            'q' : value
                        },
                        dataType: "text",
                        success: function(msg){
                            //we need to check if the value is the same
                            if (value===$(that).val()) {
                                var result = JSON.parse(msg);
                                $.each(result, function(key, arr) {
                                    $.each(arr, function(id, value) {
                                        if (key === 'menu') {
                                            if (id !== 'error') {
                                                console.log(value[1]);
                                                entitySelector.append('<ul> ');
                                                entitySelector.append('<li><a href="/event/menu/'+id+'/show">'+value+'<a/></li>');
                                                entitySelector.append('</ul> ');
                                                entitySelector.append('');



                                            } else {
                                                entitySelector.append('<li class="errorLi">'+"  " +value +"  "+'</li> ');
                                            }
                                        }
                                    });
                                });
                            }
                        }
                    });
                }
            });
        });
    </script>




    <br><br>
    <h2><label  for="topicOptions" style="font-size: 20px; color: #5bc0de;" class="ng-binding" >La liste des menus </label></h2>

    <TABLE class="table table-striped" >
        <tr> <th > <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Entree</label></th>
            <th> <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Plat</label></th>
            <th> <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Dessert</label></th>
            <th><label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Date</label> </th>

            <th> <label  for="topicOptions" style="font-size: 14px; color: #5bc0de;" class="ng-binding" >Actions</label> </th></tr>




        {% for menu in menus %}


            <tr>

                <td>  {{ menu.entre }}</td>
                <td>  {{ menu.plat }}</td>
                <td>  {{ menu.dessert }}</td>
                <td>  {% if menu.date %}{{ menu.date|date('Y-m-d') }}{% endif %}</td>





                <td>  <a href="{{ path('menu_delete2',{'id':menu.id}) }}" class="btn btn-primary"><i class="fa fa-trash"></i> </a>



                    <form action="{{ path('menu_edit', { 'id': menu.id }) }}" style="display: inline-block" onsubmit="return confirm('Etes vous vraiment sur?')">
                        <input type="hidden" name="method" value="modifier">

                        <button class="btn btn-primary" ><i class="fa fa-edit"></i> </button>



                    </form>
                    <form action="{{ path('menu_show', { 'id': menu.id }) }}" style="display: inline-block" onsubmit="return confirm('Etes vous vraiment sur?')">
                        <input type="hidden" name="method" value="show">
                        <button class="btn btn-primary"><i class="fa fa-eye"></i> </button>


                    </form>




                </td>


            </tr>
        {% endfor %}
    </TABLE>

    <br>

    <div class="text-left">

        <a href="{{ path('menu_new') }}" class="btn btn-primary">  <i class="fa fa-save"> <br> Ajouter</i></a>
    </div>



    </div>

    <div class="navigation">
        {{ knp_pagination_render(menus) }}
    </div>





{% endblock %}

